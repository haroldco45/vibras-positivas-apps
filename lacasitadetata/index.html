<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Casita de Tata - Pedidos</title>
    <style>
        :root { --primario: #f9dcc4; --secundario: #f08080; --texto: #5d5d5d; --blanco: #ffffff; --exito: #25D366; }
        body { font-family: 'Segoe UI', sans-serif; background-color: #fffaf0; margin: 0; padding: 10px; padding-bottom: 180px; color: var(--texto); }
        
        /* Control Invisible */
        #bloqueo { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; color: #fff; z-index: 9999; text-align: center; padding-top: 100px; }

        header { background: var(--primario); padding: 25px; text-align: center; border-radius: 0 0 40px 40px; margin: -10px -10px 20px -10px; border-bottom: 5px solid var(--secundario); box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .logo-tata { width: 90px; height: 90px; border-radius: 50%; border: 3px solid white; background: white; margin-bottom: 10px; object-fit: contain; }

        /* Cajones de Datos Estilo JM */
        .card-datos { background: white; padding: 20px; border-radius: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); margin-bottom: 20px; border: 1px solid var(--primario); }
        .input-cajon { width: 100%; padding: 12px; margin: 6px 0; border: 1px solid #eee; border-radius: 15px; font-size: 15px; box-sizing: border-box; outline: none; background: #fffcf9; font-family: inherit; }

        .section-title { font-size: 12px; font-weight: bold; color: var(--secundario); text-transform: uppercase; margin: 25px 0 10px; border-left: 5px solid var(--primario); padding: 8px; background: white; border-radius: 0 10px 10px 0; text-align: left; }
        
        .card-prod { background: white; padding: 15px; border-radius: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); margin-bottom: 12px; border-right: 5px solid var(--primario); }
        .info-prod h3 { margin: 0; font-size: 14px; color: #444; text-align: left; }
        
        .opciones-area { display: grid; grid-template-columns: 1.4fr 1fr 1fr; gap: 8px; margin-top: 10px; align-items: center; }
        .sel-opt { width: 100%; padding: 10px; border-radius: 12px; border: 1px solid var(--primario); font-size: 11px; background: #fff; outline: none; }
        .precio-u { width: 100%; padding: 10px; border: 1px solid #eee; border-radius: 12px; text-align: center; font-size: 13px; }

        .controles { display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-c { background: var(--primario); color: var(--texto); border: none; width: 35px; height: 35px; border-radius: 10px; font-weight: bold; cursor: pointer; }
        .cant-n { font-weight: bold; color: var(--secundario); min-width: 20px; text-align: center; font-size: 16px; }

        /* Caj√≥n de Total */
        .cajon-total { background: var(--texto); color: var(--primario); padding: 15px; border-radius: 20px; margin: 20px 0; text-align: center; border: 2px solid var(--secundario); }
        .cajon-total small { font-size: 11px; text-transform: uppercase; }
        .cajon-total b { font-size: 24px; display: block; margin-top: 5px; }

        .footer-pedido { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 15px; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); border-radius: 30px 30px 0 0; z-index: 1000; }
        .btn-enviar { background: var(--exito); color: white; border: none; padding: 18px; border-radius: 20px; width: 100%; font-size: 18px; font-weight: bold; cursor: pointer; }
        
        footer { text-align: center; padding: 30px; font-size: 12px; color: #aaa; background: #fff; margin-top: 20px; border-top: 1px solid #eee; line-height: 1.6; }
        .brand-footer { color: var(--texto); font-weight: bold; font-size: 14px; }
    </style>
</head>
<body>

<div id="bloqueo"><h1>üîí</h1><h2>SERVICIO SUSPENDIDO</h2><p>Contacte a VIBRAS POSITIVAS</p></div>

<div id="app-content">
    <header>
        <img src="lapizzadefranco.PNG" id="logo-tata-img" class="logo-tata" onerror="this.src='https://via.placeholder.com/100?text=Tata'">
        <h1 style="margin:0; font-size: 22px;">LA CASITA DE TATA</h1>
        <small>üíõ Tejiendo con calma en Caucasia</small>
    </header>

    <div class="card-datos">
        <div class="section-title">üìç Datos para el Pedido</div>
        <input type="text" id="nom" class="input-cajon" placeholder="üë§ Nombre de quien pide">
        <input type="text" id="dir" class="input-cajon" placeholder="üè† Direcci√≥n: Altos de San Juan...">
        <input type="tel" id="tel_cli" class="input-cajon" placeholder="üìû Celular WhatsApp">
        
        <div class="section-title">üí≥ Forma de Pago</div>
        <select id="pago" class="input-cajon">
            <option value="" disabled selected>Selecciona c√≥mo pagas</option>
            <option value="Efectivo">Efectivo</option>
            <option value="Nequi">Nequi</option>
            <option value="Bancolombia">Bancolombia</option>
        </select>
        
        <textarea id="obs" class="input-cajon" placeholder="üìù Observaciones (Colores, nivel de clase, etc.)" rows="2"></textarea>
    </div>

    <div id="menu"></div>

    <div class="cajon-total">
        <small>Total de tu Pedido</small>
        <b id="total-vista">$ 0</b>
    </div>

    <div class="footer-pedido">
        <button class="btn-enviar" onclick="enviar()">üöÄ ENVIAR PEDIDO A TATA</button>
    </div>

    <footer>
        App desarrollada por <br>
        <span class="brand-footer">VIBRAS POSITIVAS</span> <br>
        Derechos de Autor ¬© 2026
    </footer>
</div>

<script>
    const WA_TATA = "573127508669";
    
    const carta = [
        { cat: "üß∂ Hilos y Cordones", prods: [
            { id: 1, n: "Hilo Algod√≥n (Amigurumi)", t: "col" },
            { id: 2, n: "Hilo Macram√©", t: "col" },
            { id: 3, n: "Trapillo Premium", t: "col" },
            { id: 4, n: "Cord√≥n Macram√©", t: "col" }
        ]},
        { cat: "üêë Lanas Especiales", prods: [
            { id: 5, n: "Lana Acr√≠lica Suave", t: "col" },
            { id: 6, n: "Lana Beb√© Antial√©rgica", t: "col" },
            { id: 7, n: "Lana Chunky (Gruesa)", t: "col" }
        ]},
        { cat: "ü•¢ Agujas y Ganchillos", prods: [
            { id: 8, n: "Aguja Ergon√≥mica", t: "tam" },
            { id: 9, n: "Aguja Aluminio / Bamb√∫", t: "tam" },
            { id: 10, n: "Aguja Lanera / Metal", t: "tam" }
        ]},
        { cat: "üéÄ Insumos y Accesorios", prods: [
            { id: 11, n: "Ojitos de Seguridad (Par)", t: "tam" },
            { id: 12, n: "Relleno Siliconado (Nube)", t: "tam" },
            { id: 13, n: "Marcadores de Puntos", t: "tam" },
            { id: 14, n: "Cinta M√©trica / Tijeras", t: "tam" }
        ]},
        { cat: "üéì Clases y Cursos", prods: [
            { id: 15, n: "Clase Ni√±os (S√°bados)", t: "cur" },
            { id: 16, n: "Taller Adultos", t: "cur" },
            { id: 17, n: "Asesor√≠a Proyecto", t: "cur" }
        ]}
    ];

    let ped = {}; let precios = {}; let detalles = {};
    const cols = ["Crudo", "Blanco", "Negro", "Rojo", "Azul", "Rosa Pastel", "Verde Menta", "Lila", "Gris"];
    const tams = ["Peque√±o", "Mediano", "Grande", "2.0mm", "3.0mm", "4.0mm", "5.0mm", "6.0mm"];
    const curs = ["Nivel Cero", "Amigurumi", "Prendas", "Trapillo", "Decoraci√≥n"];

    function render() {
        const m = document.getElementById('menu');
        carta.forEach(s => {
            const t = document.createElement('div'); t.className='section-title'; t.innerText=s.cat; m.appendChild(t);
            s.prods.forEach(p => {
                const c = document.createElement('div'); c.className='card-prod';
                let opt = `<select class="sel-opt" onchange="setDet(${p.id}, this.value)"><option value="">${p.t=='col'?'üé® Color':(p.t=='tam'?'üìè Tama√±o':'üéì Curso')}</option>`;
                let list = p.t=='col' ? cols : (p.t=='tam' ? tams : curs);
                list.forEach(x => opt += `<option value="${x}">${x}</option>`);
                opt += `</select>`;

                c.innerHTML = `
                <div class="info-prod"><h3>${p.n}</h3></div>
                <div class="opciones-area">
                    ${opt}
                    <input type="number" class="precio-u" placeholder="$ Val" oninput="setP(${p.id}, this.value)">
                    <div class="controles">
                        <button class="btn-c" onclick="cant(${p.id},-1)">-</button>
                        <span id="q-${p.id}" class="cant-n">0</span>
                        <button class="btn-c" onclick="cant(${p.id},1)">+</button>
                    </div>
                </div>`;
                m.appendChild(c);
            });
        });
    }
    render();

    function setDet(id, v) { detalles[id] = v; }
    function setP(id, v) { precios[id] = parseFloat(v) || 0; calc(); }
    function cant(id, v) { ped[id] = Math.max(0, (ped[id] || 0) + v); document.getElementById(`q-${id}`).innerText = ped[id]; calc(); }

    function calc() {
        let total = 0;
        for(let id in ped) if(ped[id]) total += (ped[id] * (precios[id] || 0));
        document.getElementById('total-vista').innerText = `$ ${total.toLocaleString()}`;
    }

    function enviar() {
        const n = document.getElementById('nom').value, d = document.getElementById('dir').value, 
              c = document.getElementById('tel_cli').value, p = document.getElementById('pago').value,
              o = document.getElementById('obs').value;
        
        if(!n || !d || !c || !p) return alert("Por favor completa tus datos y forma de pago.");
        
        let r = ""; let total = 0;
        for(let id in ped) {
            if(ped[id]) {
                const prod = carta.flatMap(s => s.prods).find(x => x.id == id);
                const sub = ped[id] * (precios[id] || 0);
                total += sub;
                r += `‚Ä¢ ${ped[id]}x ${prod.n} (${detalles[id] || 'N/A'}) = *$${sub.toLocaleString()}*\n`;
            }
        }
        if(!r) return alert("Agrega alg√∫n producto o clase.");

        let msg = `*üß∂ LA CASITA DE TATA - PEDIDO*\n------------------\nüë§ *CLIENTE:* ${n}\nüè† *DIR:* ${d}\nüìû *CEL:* ${c}\nüí≥ *PAGO:* ${p}\n------------------\nüõí *DETALLE:*\n${r}------------------\nüí∞ *TOTAL: $${total.toLocaleString()}*\nüìù *OBS:* ${o || "Sin notas"}\n\n_App desarrollada por Vibras Positivas_`;
        window.open(`https://wa.me/${WA_TATA}?text=${encodeURIComponent(msg)}`);
    }

    async function check() {
        try {
            const r = await fetch('https://haroldco45.github.io/control-vibras.js');
            const t = await r.text();
            if(t.includes('"lacasitadetata": "suspendido"')) {
                document.getElementById('bloqueo').style.display='block';
                document.getElementById('app-content').style.display='none';
            }
        } catch(e){}
    }
    check();
</script>
</body>
</html>
