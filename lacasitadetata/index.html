<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Casita de Tata - Pedidos y Clases</title>
    <style>
        :root { --primario: #f9dcc4; --secundario: #f08080; --texto: #5d5d5d; --blanco: #ffffff; --exito: #25D366; }
        body { font-family: 'Segoe UI', sans-serif; background-color: #fffaf0; margin: 0; padding: 10px; padding-bottom: 180px; color: var(--texto); }
        
        #bloqueo { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; color: #fff; z-index: 9999; text-align: center; padding-top: 100px; }

        header { background: var(--primario); padding: 25px; text-align: center; border-radius: 0 0 40px 40px; margin: -10px -10px 20px -10px; border-bottom: 5px solid var(--secundario); }
        .logo-tata { width: 80px; height: 80px; border-radius: 50%; border: 3px solid white; background: white; margin-bottom: 10px; }

        .card-datos { background: white; padding: 20px; border-radius: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); margin-bottom: 20px; border: 1px solid var(--primario); }
        .input-cajon { width: 100%; padding: 12px; margin: 6px 0; border: 1px solid #eee; border-radius: 15px; font-size: 15px; box-sizing: border-box; outline: none; background: #fffcf9; }

        .section-title { font-size: 13px; font-weight: bold; color: var(--secundario); text-transform: uppercase; margin: 25px 0 10px; border-left: 5px solid var(--primario); padding: 8px; background: white; border-radius: 0 10px 10px 0; }
        
        .card-prod { background: white; padding: 15px; border-radius: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); margin-bottom: 12px; border-right: 5px solid var(--primario); }
        .info-prod h3 { margin: 0; font-size: 15px; color: #444; }
        
        .opciones-area { display: grid; grid-template-columns: 1.5fr 1fr 1fr; gap: 8px; margin-top: 10px; align-items: center; }
        .sel-opt { width: 100%; padding: 8px; border-radius: 10px; border: 1px solid var(--primario); font-size: 12px; background: #fff; outline: none; }

        .precio-u { width: 100%; padding: 8px; border: 1px solid #eee; border-radius: 10px; text-align: center; font-size: 13px; }

        .controles { display: flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-c { background: var(--primario); color: var(--texto); border: none; width: 30px; height: 30px; border-radius: 8px; font-weight: bold; }
        .cant-n { font-weight: bold; color: var(--secundario); min-width: 15px; text-align: center; }

        .cajon-total { background: var(--texto); color: var(--primario); padding: 15px; border-radius: 20px; margin: 20px 0; text-align: center; }
        .cajon-total b { font-size: 22px; display: block; }

        .footer-pedido { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 15px; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); border-radius: 30px 30px 0 0; z-index: 1000; }
        .btn-enviar { background: var(--exito); color: white; border: none; padding: 18px; border-radius: 20px; width: 100%; font-size: 18px; font-weight: bold; }
        
        footer { text-align: center; padding: 20px; font-size: 11px; color: #aaa; border-top: 1px solid #eee; }
    </style>
</head>
<body>

<div id="bloqueo"><h1>üîí</h1><h2>SERVICIO SUSPENDIDO</h2><p>Contacte a VIBRAS POSITIVAS</p></div>

<div id="app-content">
    <header>
        <img src="logo_tata.png" class="logo-tata">
        <h1 style="margin:0; font-size: 20px;">LA CASITA DE TATA</h1>
        <small>üß∂ Tejiendo procesos creativos en Caucasia</small>
    </header>

    <div class="card-datos">
        <input type="text" id="nom" class="input-cajon" placeholder="üë§ Nombre o Negocio">
        <input type="text" id="dir" class="input-cajon" placeholder="üè† Direcci√≥n de Entrega / Clase">
        <input type="tel" id="tel_cli" class="input-cajon" placeholder="üìû Celular">
        <textarea id="obs" class="input-cajon" placeholder="üìù Notas especiales..."></textarea>
    </div>

    <div id="menu"></div>

    <div class="cajon-total">
        <small>TOTAL ESTIMADO DEL PEDIDO</small>
        <b id="total-vista">$ 0</b>
    </div>

    <div class="footer-pedido">
        <button class="btn-enviar" onclick="enviar()">üöÄ ENVIAR PEDIDO A TATA</button>
    </div>

    <footer>App hecha por <b>VIBRAS POSITIVAS</b><br>Derecho de Autor ¬© 2026</footer>
</div>

<script>
    const WA_TATA = "573127508669";
    
    const carta = [
        { cat: "üß∂ Hilos y Lanas", prods: [
            { id: 1, n: "Hilo Algod√≥n", t: "col" },
            { id: 2, n: "Lana Acr√≠lica", t: "col" },
            { id: 3, n: "Trapillo Premium", t: "col" }
        ]},
        { cat: "‚ú® Clases Personalizadas", prods: [
            { id: 4, n: "Clase para Ni√±os", t: "cur" },
            { id: 5, n: "Taller J√≥venes/Adultos", t: "cur" },
            { id: 6, n: "Curso Intensivo", t: "cur" }
        ]}
    ];

    let ped = {}; let precios = {}; let detalles = {};
    const cols = ["Blanco", "Negro", "Crudo", "Rojo", "Azul", "Rosa", "Verde", "Lila", "Menta"];
    const curs = ["Nivel B√°sico", "Amigurumi", "Prendas", "Decoraci√≥n", "Puntos Avanzados"];

    function render() {
        const m = document.getElementById('menu');
        carta.forEach(s => {
            const t = document.createElement('div'); t.className='section-title'; t.innerText=s.cat; m.appendChild(t);
            s.prods.forEach(p => {
                const c = document.createElement('div'); c.className='card-prod';
                let opt = `<select class="sel-opt" onchange="setDet(${p.id}, this.value)"><option value="">${p.t=='col'?'üé® Color':'üéì Curso'}</option>`;
                (p.t=='col' ? cols : curs).forEach(x => opt += `<option value="${x}">${x}</option>`);
                opt += `</select>`;

                c.innerHTML = `
                <div class="info-prod"><h3>${p.n}</h3></div>
                <div class="opciones-area">
                    ${opt}
                    <input type="number" class="precio-u" placeholder="$ Val" oninput="setP(${p.id}, this.value)">
                    <div class="controles">
                        <button class="btn-c" onclick="cant(${p.id},-1)">-</button>
                        <span id="q-${p.id}" class="cant-n">0</span>
                        <button class="btn-c" onclick="cant(${p.id},1)">+</button>
                    </div>
                </div>`;
                m.appendChild(c);
            });
        });
    }
    render();

    function setDet(id, v) { detalles[id] = v; }
    function setP(id, v) { precios[id] = parseFloat(v) || 0; calc(); }
    function cant(id, v) { ped[id] = Math.max(0, (ped[id] || 0) + v); document.getElementById(`q-${id}`).innerText = ped[id]; calc(); }

    function calc() {
        let total = 0;
        for(let id in ped) if(ped[id]) total += (ped[id] * (precios[id] || 0));
        document.getElementById('total-vista').innerText = `$ ${total.toLocaleString()}`;
    }

    function enviar() {
        const n = document.getElementById('nom').value, d = document.getElementById('dir').value, c = document.getElementById('tel_cli').value;
        if(!n || !d || !c) return alert("Completa tus datos.");
        
        let r = ""; let total = 0;
        for(let id in ped) {
            if(ped[id]) {
                const prod = carta.flatMap(s => s.prods).find(x => x.id == id);
                const sub = ped[id] * (precios[id] || 0);
                total += sub;
                r += `‚Ä¢ ${ped[id]}x ${prod.n} (${detalles[id] || 'N/A'}) = *$${sub.toLocaleString()}*\n`;
            }
        }
        if(!r) return alert("Selecciona un producto o curso.");
        
        let msg = `*üß∂ LA CASITA DE TATA - PEDIDO*\n------------------\nüë§ *CLIENTE:* ${n}\nüè† *DIR:* ${d}\nüìû *CEL:* ${c}\n------------------\nüõí *DETALLE:*\n${r}------------------\nüí∞ *TOTAL: $${total.toLocaleString()}*\nüìù *OBS:* ${document.getElementById('obs').value || "Sin notas"}\n\n_VIBRAS POSITIVAS ¬© 2026_`;
        window.open(`https://wa.me/${WA_TATA}?text=${encodeURIComponent(msg)}`);
    }

    async function check() {
        try {
            const r = await fetch('https://haroldco45.github.io/control-vibras.js');
            const t = await r.text();
            if(t.includes('"lacasitadetata": "suspendido"')) {
                document.getElementById('bloqueo').style.display='block';
                document.getElementById('app-content').style.display='none';
            }
        } catch(e){}
    }
    check();
</script>
</body>
</html>
